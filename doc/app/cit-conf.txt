= Configuration file: cit.conf =
Maarten van Dootingh <maarten@vdtai.nl>

Revision history

[cols="1^,4,10",options="header"]
|===================================================
|Version|Date            |Comment
|v1.0 	|March 18 2010   |Initial version
|v1.1   |April 2 2010    |Update documenting authentication section
|===================================================

== Introduction == 

The NQuire can be configured using a configuration file: cit.conf. This file can
be maintained using the webui, or manually using a text-editor. When using the 
text-editor, one should first download the file from the nquire using ftp.
Than the file has to be changed, after which the file can be uploaded using ftp.

When changing the file, one should adhere to the format of the file.

The configuration file can also be used to reset the configuration when the
nquire has become unreachable (eg passwords forgotten). Ressetting is done by
putting a cit.conf on a micro-sd card and insert that in the device. 
During boot, that file will be used instead.

== Format ==

The configuration file is a line oriented file.
Each line contains one of:
 - an empty line
 - a comment line (starting with a '#'
 - a configuration item.

A configuration line is formatted as follows:

-------
<config-id> '=' <value>

or 

<config-id> '=' "<value>"
-------

The config-id exists of a path and a name. The '=' sign can be surrounded by 
space or tab charracters , which will be ignored. When a value has spaces in it,
one can use quotes. 
All string values will be quoted when generated by the nquire application.

Only escape charracters that have any meaning are implemented for string values.
These are:

-------
\n     translates as a new-line charracter (=\x0a)
\"     translates as a quote ('"')
\\     translates as ('\')
\xnn   translates as the hexadecimal charracter value equal to nn
-------

When the escape charracter '\' is used before any other charracter, it is just
left as is.

Eg:
-------
/dev/mifare/msg/incomplete_scan/text = "Wait for \"beep\" when scanning"
-------

Note that using control charracters other than '\n' has no meaning for string
values such as the welcome message.


Consequently, the webui has no way of dealing with these escapes.

== Comment on some settings ==

=== Authentication ===

When authentication is turned on in the webui, the nquire will be username and
password protected. The same username and password is used for the webui as for
ftp access.

E.g.:

------
# Authentication

/dev/auth/enable = true
/dev/auth/username = "piet"
/dev/auth/encrypted = "BwVYu14F3zRDalosNitNU/"
------

The password is not stored unencrypted.
It is possible to use a settings barcode or a cit.conf to change the 
authentication of the device.

NOTE: the encrypted password has to be generated by the nquire. This can be done
	by setting the password using the webui and than download the cit.conf.

NOTE: enabling authentication (either by magic barcode or by upload of cit.conf)
	should always be accompanied by an encrypted password.
	
NOTE: the username is NOT reset when disabling authentication. This means that
	enabling authentication with only /dev/auth/enable and /dev/auth/encrypted
	will work using the previous password!

E.g. (user=piet, password=puck):

image:img/auth_on_piet_puck.png[user=piet, password=puck]



== Default content ==

The default content as of application version 1.4 is:

-------

# Settings


# CIT settings

/cit/codepage = "ibm852"
# the TCP port to connect to when /cit/mode="client", "TCP client" or "TCP client on scan".
# In server orTCP server is is the port on which is listend for incoming connects
/cit/tcp_port = 9101
# the port to send packet to (mode=server, udp server) and to listen
/cit/udp_port = 9000
/cit/mode = "server"
# ip address or hostname. Used for sending udp messages or connecting int client mode.
# When a hostname is specified:
# /network/ip/ns1 and /network/ip/ns2 should be valid. 
# A resolved address is chached for 24 hours.
/cit/remote_ip = 192.168.1.100
/cit/disable_scan_beep = false
/cit/programming_mode_timeout = 15
# the logging level. In normal operation this should be 3. 4=debug, and 5=dump.
/cit/loglevel = 4
# the character that is used to seperate messages comming from and received by the nquire.
/cit/message_separator = "LF"
# this is how messages are encrypted. Currently only base64 is possible (note this is not really encryption)
/cit/message_encryption = "none"

# Messages


# Font sizes

# the font sizes to be used for 'large' and 'small' (escape codes).
# Recommanded is to use multiples of 6, starting at 12
/cit/messages/fontsize/small = 18
/cit/messages/fontsize/large = 28

# Idle message

# the delay for showing the idle message after displaying something using an escape command
/cit/messages/idle/timeout = 3

# 

/cit/messages/idle/picture/show = false
/cit/messages/idle/picture/xpos = 0
/cit/messages/idle/picture/ypos = 0

# Line 1

/cit/messages/idle/1/text = "Welcome NOW"
/cit/messages/idle/1/xpos = 0
/cit/messages/idle/1/ypos = 10
/cit/messages/idle/1/valign = "top"
/cit/messages/idle/1/halign = "center"
/cit/messages/idle/1/size = "large"

# Line 2

/cit/messages/idle/2/text = "Scan your product"
/cit/messages/idle/2/xpos = 0
/cit/messages/idle/2/ypos = 50
/cit/messages/idle/2/valign = "top"
/cit/messages/idle/2/halign = "center"
/cit/messages/idle/2/size = "small"

# Line 3

/cit/messages/idle/3/text = "↓ ↓ ↓ ↓"
/cit/messages/idle/3/xpos = 0
/cit/messages/idle/3/ypos = 80
/cit/messages/idle/3/valign = "top"
/cit/messages/idle/3/halign = "center"
/cit/messages/idle/3/size = "small"

# Error message

/cit/messages/error/timeout = 1

# Line 1

/cit/messages/error/1/text = "Please ask"
/cit/messages/error/1/xpos = 0
/cit/messages/error/1/ypos = 30
/cit/messages/error/1/valign = "top"
/cit/messages/error/1/halign = "center"
/cit/messages/error/1/size = "small"

# Line 2

/cit/messages/error/2/text = "for assistance"
/cit/messages/error/2/xpos = 0
/cit/messages/error/2/ypos = 60
/cit/messages/error/2/valign = "top"
/cit/messages/error/2/halign = "center"
/cit/messages/error/2/size = "small"

# Network settings

# Also specify the correct wifi settings when using "wifi"
# Wifi is only valid when the nquire has the wifi hw option.
/network/interface = "ethernet"
# also specify the correct ip settings when false.
/network/dhcp = false

# 


# 

# use tcp keepalive: Only disable when you know what you are doing.
/network/tcp_keepalive/use_keepalive = true
/network/tcp_keepalive/time = 60
/network/tcp_keepalive/intvl = 20
/network/tcp_keepalive/probes = 6

# IP settings
# the addres of the nquire when /network/dhcp=false
/network/ip/address = 192.168.1.200
/network/ip/netmask = 255.255.255.0
/network/ip/gateway = 192.168.1.1
# the used nameservers. Only important when /network/dhcp=false and 
# remote_ip is a name instead of an ip-address. 
/network/ip/ns1 = 194.168.1.1
/network/ip/ns2 = 194.168.1.1

# Wlan settings
# only required when /network/interface="wifi"
/network/wifi/essid = "yggdrasil"
/network/wifi/keytype = "WPA / WPA2"
/network/wifi/key = "Assuransetourix1."

# GPRS/UMTS settings

/network/gprs/pin = 0000
/network/gprs/username = ""
/network/gprs/password = ""
/network/gprs/apn = "internet"
/network/gprs/number = "*99***1#"

# Device settings

/dev/name = "Newland NQuire 200"

# Authentication

/dev/auth/enable = false
/dev/auth/username = "admin"
/dev/auth/encrypted = ""

# Barcode authentication

/dev/barcode_auth/enable = false
/dev/barcode_auth/security_code = "0000"

# Modem

/dev/modem/device = "/dev/ttyS1"
/dev/modem/baudrate = 9600

# Scanner

/dev/scanner/barcodes = "1D only"
/dev/scanner/enable_barcode_id = true
/dev/scanner/prevent_duplicate_scan_timeout = NOP
/dev/scanner/illumination_led = "Blinking"
/dev/scanner/default_illumination_leds = "On"
/dev/scanner/reading_sensitivity = "Low"
/dev/scanner/aiming_led = "Blinking"
/dev/scanner/1d_scanning_mode = "Sensor mode"
/dev/scanner/multi_reading_constraint = "Semi"

# use the next options for additional scanner settings
# watch out: this can disturb correct operation
/dev/scanner/em1300_pre_init = ""
/dev/scanner/em1300_post_init = ""
/dev/scanner/em2027_pre_init = ""
/dev/scanner/em2027_post_init = ""

# Barcodes

/dev/scanner/enable-disable/UCC_EAN-128 = true
/dev/scanner/enable-disable/EAN-8 = true
/dev/scanner/enable-disable/EAN-13 = true
/dev/scanner/enable-disable/UPC-E = true
/dev/scanner/enable-disable/UPC-A = true
/dev/scanner/enable-disable/Interleaved-2_of_5 = true
/dev/scanner/enable-disable/Code39 = true
/dev/scanner/enable-disable/Codabar = true
/dev/scanner/enable-disable/Code93 = true
/dev/scanner/enable-disable/GS1_Databar = true
/dev/scanner/enable-disable/ISBN = true
/dev/scanner/enable-disable/Code-11 = true
/dev/scanner/enable-disable/2_5-Matrix = true
/dev/scanner/enable-disable/ITF14 = true
/dev/scanner/enable-disable/MSI-Plessey = true
/dev/scanner/enable-disable/Plessey = true
/dev/scanner/enable-disable/2_5-Standard = true
/dev/scanner/enable-disable/2_5-Industrial = true
/dev/scanner/enable-disable/PDF417 = true
/dev/scanner/enable-disable/QR_Code = true
/dev/scanner/enable-disable/Aztec = true
/dev/scanner/enable-disable/DataMatrix = true
/dev/scanner/enable-disable/Chinese-Sensible = true

# External Scanner

# do not touch this
/dev/extscanner/device = "/dev/tty0"
# do not replace the prefix in the external scanner data (but add another)
/dev/extscanner/raw = true

# Mifare scanner

# do not touch this
/dev/mifare/device = "/dev/ttyS2"
# the key to be used when reading a mifare card on card detection
# (only when relevant_sectors is not empty)
/dev/mifare/key_A = "FFFFFFFFFFFF"
# the block (or whole sectors) to be read on card-detection
/dev/mifare/relevant_sectors = "1:0,15:2"
# You can't scan the same card within this number of seconds again.
/dev/mifare/prevent_duplicate_scan_timeout = 3
# the format to be used for sending the card-number (recommended is "hexadecimal").
/dev/mifare/cardnum_format = "hexadecimal"
# only sends the card-number, even when data was read.
/dev/mifare/send_cardnum_only = false
# the format to be used for the sector data (recommended is "base 64" or "hex")
/dev/mifare/sector_data_format = "hex"
/dev/mifare/sector_data_seperator = "comma"
# When true: do not beep when a card is detected.
#This comes in handy when using escape commands to read or write the card.
/dev/mifare/suppress_beep = false
/dev/mifare/msg/incomplete_scan/text = "Wait for beep\nwhen scanning"
/dev/mifare/msg/access_violation/text = "Card access\ndenied"
/dev/mifare/msg/transaction_error_message = "Transaction failed!\n\nThis is logged."

# Error messages


# Message for

/dev/mifare/msg/incomplete_scan/text = "Wait for beep\nwhen scanning"

# Message for

/dev/mifare/msg/access_violation/text = "Card access\ndenied"
/dev/mifare/msg/transaction_error_message = "Transaction failed!\n\nThis is logged."

# Touch keypad
# do not touch this
/dev/touch16/device = "/dev/event0"
/dev/touch16/prefix = "K"
# The 'idle message timeout' for when a touch button is displayed
/dev/touch16/timeout = 60
# which beep to use when a key is pressed
/dev/touch16/keyclick = "beep1"
# better not touch these beep values
/dev/touch16/beep1 = "03a32"
/dev/touch16/beep2 = "03c100"
/dev/touch16/beep3 = "03g32"
# 
/dev/touch16/minimum_click_delay = ""
# visualize keypresses by inverting the key
/dev/touch16/invert = false
# Als send touch key clicks when no button is displayed.
# This is handy for keypad activation on touch
/dev/touch16/send_active_keys_only = true

# GPIO

/dev/gpio/prefix = "I"
# When should gpio be read: "On read GPIO","On change" or "Poll"
/dev/gpio/method = "On read GPIO"
# when method="Poll" a gpio event will be generated every poll_delay seconds, and
# when a level did change
/dev/gpio/poll_delay = "5"

# Beeper

/dev/beeper/device = "/dev/beeper"
/dev/beeper/volume = 4
/dev/beeper/beeptype = 1
/dev/beeper/tune_startup = "o3c16g16"
/dev/beeper/tune_shutdown = "o3g16c16"
/dev/beeper/tune_error = "o3c16o2f8"
/dev/beeper/tune_1 = "o3c32"
/dev/beeper/tune_2 = "o4c32"
/dev/beeper/tune_3 = "o5c32"

# Display

# do not touch this
/dev/display/mode = "240x128m"
# recommended: do not touch this
/dev/display/contrast = 2
# recommended: do not touch this
/dev/display/contrast_min = 100
# recommended: do not touch this
/dev/display/contrast_max = 160

# End


-------
